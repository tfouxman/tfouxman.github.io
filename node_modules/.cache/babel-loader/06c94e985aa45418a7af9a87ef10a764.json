{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = __importStar(require(\"react\"));\n\nvar UnityLoaderService_1 = __importDefault(require(\"../services/UnityLoaderService\"));\n\nrequire(\"../declarations/UnityLoader\");\n\nrequire(\"../declarations/UnityInstance\");\n\nrequire(\"../declarations/ReactUnityWebgl\");\n\nvar Unity =\n/** @class */\nfunction (_super) {\n  __extends(Unity, _super);\n  /**\n   * Initialized the component.\n   * @param {IUnityProps} props\n   */\n\n\n  function Unity(props) {\n    var _this = _super.call(this, props) || this;\n    /**\n     * The component state.\n     * @type {IUnityState}\n     * @public\n     */\n\n\n    _this.state = {};\n    _this.unityLoaderService = new UnityLoaderService_1.default();\n    _this.onWindowResizeBinding = _this.onWindowResize.bind(_this);\n    _this.unityContent = _this.props.unityContent;\n\n    _this.unityContent.setComponentInstance(_this);\n\n    return _this;\n  }\n  /**\n   * An event that is triggered by the Unity player. This tracks\n   * the loading progression of the player. It will send '1' when\n   * the loading is completed.\n   * @param {UnityInstance} unityInstance\n   * @param {number} progression\n   * @private\n   */\n\n\n  Unity.prototype.onProgress = function (unityInstance, progression) {\n    this.unityContent.triggerUnityEvent(\"progress\", progression);\n    if (progression === 1) this.unityContent.triggerUnityEvent(\"loaded\");\n  };\n  /**\n   * When the window is resized.\n   */\n\n\n  Unity.prototype.onWindowResize = function () {\n    if (this.unityContent.unityConfig.adjustOnWindowResize === true) {\n      this.unityContent.triggerUnityEvent(\"resized\");\n      this.adjustCanvasToContainer();\n    }\n  };\n  /**\n   * Since the Unity canvas itself does not respond to the resizing\n   * of it's container we have to manually do this. A width and height\n   * of 100% does not seem to work, so we have to fetch it's parent's\n   * size to adject the canvas.\n   * @private\n   */\n\n\n  Unity.prototype.adjustCanvasToContainer = function () {\n    if (typeof this.htmlElement !== \"undefined\") {\n      var _width = this.htmlElement.offsetWidth;\n      var _height = this.htmlElement.offsetHeight;\n      var _canvas = this.htmlElement.getElementsByTagName(\"canvas\")[0];\n      if (typeof _canvas !== \"undefined\" && _canvas.height !== _height) _canvas.height = _height;\n      if (typeof _canvas !== \"undefined\" && _canvas.width !== _width) _canvas.width = _width;\n    }\n  };\n  /**\n   * Initialzied the Unity player when the component is mounted.\n   * @public\n   */\n\n\n  Unity.prototype.componentDidMount = function () {\n    var _this = this;\n\n    window.addEventListener(\"resize\", this.onWindowResizeBinding); // prettier-ignore\n\n    this.unityLoaderService.append(this.props.unityContent.unityLoaderJsPath, function () {\n      UnityLoader.Error.handler = function (_message) {\n        _this.unityContent.triggerUnityEvent(\"error\", _message);\n\n        console.error(\"React Unity WebGL\", _message);\n      };\n\n      _this.unityContent.setUnityInstance(UnityLoader.instantiate(\"__ReactUnityWebGL_\" + _this.props.unityContent.uniqueID + \"__\", _this.props.unityContent.buildJsonPath, {\n        onProgress: _this.onProgress.bind(_this),\n        Module: _this.props.unityContent.unityConfig.modules,\n        width: \"100%\",\n        height: \"100%\"\n      }));\n    });\n  };\n  /**\n   * Will remove event listeners and clean up systems when the\n   * component is about to unmount.\n   * @public\n   */\n\n\n  Unity.prototype.componentWillUnmount = function () {\n    this.unityContent.remove();\n    window.removeEventListener(\"resize\", this.onWindowResizeBinding);\n  };\n  /**\n   * Renders the unity wrapper and player.\n   * @returns {React.ReactNode} element\n   * @public\n   */\n\n\n  Unity.prototype.render = function () {\n    var _this = this;\n\n    return React.createElement(\"div\", {\n      className: this.props.className || \"\",\n      ref: function (ref) {\n        return _this.htmlElement = ref;\n      },\n      id: \"__ReactUnityWebGL_\" + this.props.unityContent.uniqueID + \"__\",\n      style: {\n        width: this.props.width || \"800px\",\n        height: this.props.height || \"600px\"\n      }\n    });\n  };\n\n  return Unity;\n}(React.Component);\n\nexports.default = Unity;","map":{"version":3,"sources":["../../source/components/Unity.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __importStar(require(\"react\"));\nvar UnityLoaderService_1 = __importDefault(require(\"../services/UnityLoaderService\"));\nrequire(\"../declarations/UnityLoader\");\nrequire(\"../declarations/UnityInstance\");\nrequire(\"../declarations/ReactUnityWebgl\");\nvar Unity = /** @class */ (function (_super) {\n    __extends(Unity, _super);\n    /**\n     * Initialized the component.\n     * @param {IUnityProps} props\n     */\n    function Unity(props) {\n        var _this = _super.call(this, props) || this;\n        /**\n         * The component state.\n         * @type {IUnityState}\n         * @public\n         */\n        _this.state = {};\n        _this.unityLoaderService = new UnityLoaderService_1.default();\n        _this.onWindowResizeBinding = _this.onWindowResize.bind(_this);\n        _this.unityContent = _this.props.unityContent;\n        _this.unityContent.setComponentInstance(_this);\n        return _this;\n    }\n    /**\n     * An event that is triggered by the Unity player. This tracks\n     * the loading progression of the player. It will send '1' when\n     * the loading is completed.\n     * @param {UnityInstance} unityInstance\n     * @param {number} progression\n     * @private\n     */\n    Unity.prototype.onProgress = function (unityInstance, progression) {\n        this.unityContent.triggerUnityEvent(\"progress\", progression);\n        if (progression === 1)\n            this.unityContent.triggerUnityEvent(\"loaded\");\n    };\n    /**\n     * When the window is resized.\n     */\n    Unity.prototype.onWindowResize = function () {\n        if (this.unityContent.unityConfig.adjustOnWindowResize === true) {\n            this.unityContent.triggerUnityEvent(\"resized\");\n            this.adjustCanvasToContainer();\n        }\n    };\n    /**\n     * Since the Unity canvas itself does not respond to the resizing\n     * of it's container we have to manually do this. A width and height\n     * of 100% does not seem to work, so we have to fetch it's parent's\n     * size to adject the canvas.\n     * @private\n     */\n    Unity.prototype.adjustCanvasToContainer = function () {\n        if (typeof this.htmlElement !== \"undefined\") {\n            var _width = this.htmlElement.offsetWidth;\n            var _height = this.htmlElement.offsetHeight;\n            var _canvas = this.htmlElement.getElementsByTagName(\"canvas\")[0];\n            if (typeof _canvas !== \"undefined\" && _canvas.height !== _height)\n                _canvas.height = _height;\n            if (typeof _canvas !== \"undefined\" && _canvas.width !== _width)\n                _canvas.width = _width;\n        }\n    };\n    /**\n     * Initialzied the Unity player when the component is mounted.\n     * @public\n     */\n    Unity.prototype.componentDidMount = function () {\n        var _this = this;\n        window.addEventListener(\"resize\", this.onWindowResizeBinding);\n        // prettier-ignore\n        this.unityLoaderService.append(this.props.unityContent.unityLoaderJsPath, function () {\n            UnityLoader.Error.handler = function (_message) {\n                _this.unityContent.triggerUnityEvent(\"error\", _message);\n                console.error(\"React Unity WebGL\", _message);\n            };\n            _this.unityContent.setUnityInstance(UnityLoader.instantiate(\"__ReactUnityWebGL_\" + _this.props.unityContent.uniqueID + \"__\", _this.props.unityContent.buildJsonPath, {\n                onProgress: _this.onProgress.bind(_this),\n                Module: _this.props.unityContent.unityConfig.modules,\n                width: \"100%\",\n                height: \"100%\"\n            }));\n        });\n    };\n    /**\n     * Will remove event listeners and clean up systems when the\n     * component is about to unmount.\n     * @public\n     */\n    Unity.prototype.componentWillUnmount = function () {\n        this.unityContent.remove();\n        window.removeEventListener(\"resize\", this.onWindowResizeBinding);\n    };\n    /**\n     * Renders the unity wrapper and player.\n     * @returns {React.ReactNode} element\n     * @public\n     */\n    Unity.prototype.render = function () {\n        var _this = this;\n        return React.createElement(\"div\", {\n            className: this.props.className || \"\",\n            ref: function (ref) { return (_this.htmlElement = ref); },\n            id: \"__ReactUnityWebGL_\" + this.props.unityContent.uniqueID + \"__\",\n            style: {\n                width: this.props.width || \"800px\",\n                height: this.props.height || \"600px\"\n            }\n        });\n    };\n    return Unity;\n}(React.Component));\nexports.default = Unity;\n//# sourceMappingURL=Unity.js.map"]},"metadata":{},"sourceType":"script"}